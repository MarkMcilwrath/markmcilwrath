<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" content="width=device-width, initial-scale=1">
	    <title>Report Menu</title>

		<link rel="shortcut icon" href="#">
	    <script src="https://unpkg.com/@popperjs/core@2"></script>
	    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
	    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	    <link href="https://unpkg.com/tabulator-tables@4.9.3/dist/css/tabulator.min.css" rel="stylesheet">
	    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.9.3/dist/js/tabulator.min.js"></script>
	    <script type="text/javascript" src="https://oss.sheetjs.com/sheetjs/xlsx.full.min.js"></script>
	    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>
	    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.0.5/jspdf.plugin.autotable.js"></script>
	    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
	    <meta http-equiv="X-UA-Compatible" content="IE=edge">
	    <meta name="viewport" content="width=device-width, initial-scale=1">
	    <link href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round" rel="stylesheet">
	    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
	    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	    <link href="https://unpkg.com/tabulator-tables@4.9.3/dist/css/tabulator.min.css" rel="stylesheet">
	    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.9.3/dist/js/tabulator.min.js"></script>
	    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

	    <script src="../../chart/node_modules/chart.js/dist/chart.js"></script>

	    <link rel="stylesheet" href="../../project.css">

	     <script>
	    	$(function(){
	    		$("#includedContent").load("./adminMenu2.html");
	        });
	    </script>
</head>
<body>
	<div id="includedContent">
	</div>

	<div class="container">
   		<div class="center">
   			<div class="menuButtonHolder">
                <button type="button" class="btn btn-primary btn-lg btn-block"  onclick="licenseLocationReport()" >License Location Report</button>
            </div>
        </div>
    </div>

    <div class="container">
   		<div class="center">
   			<div class="menuButtonHolder">
                <button type="button" class="btn btn-primary btn-lg btn-block"  onclick="licenseDepartmentReport()" >License Department Report</button>
            </div>
        </div>
    </div>

    <div class="container">
   		<div class="center">
   			<div class="menuButtonHolder">
                <button type="button" class="btn btn-primary btn-lg btn-block"  onclick="assetLocationReport()" >Asset Location Report</button>
                
            </div>
        </div>
    </div>

    <div class="container">
   		<div class="center">
   			<div class="menuButtonHolder">
                <button type="button" class="btn btn-primary btn-lg btn-block"  onclick="assetDepartmentReport()" >Asset Department Report</button>
            </div>
        </div>
    </div>

    <div class="container">
   		<div class="center">
   			<div class="menuButtonHolder">
                <button type="button" class="btn btn-primary btn-lg btn-block"  onclick="startExpiryLicenses()" >Licenses with Expiry Dates</button>
            </div>
        </div>
    </div>

    <div class="container">
   		<div class="center">
   			<div class="menuButtonHolder">
                <button type="button" class="btn btn-primary btn-lg btn-block"  onclick="startExpiredLicenses()" >Expired Licenses</button>
            </div>
        </div>
    </div>

    <div class="container">
   		<div class="center">
   			<div class="menuButtonHolder">
                <button type="button" class="btn btn-primary btn-lg btn-block"  onclick="startExpiringLicenses()" >Licenses expiring in 30 Days</button>
            </div>
        </div>
    </div>

    <div class="container">
   		<div class="center">
   			<div class="menuButtonHolder">
                <button type="button" class="btn btn-primary btn-lg btn-block"  onclick="startArchivedLicenses()" >Archived Licenses</button>
            </div>
        </div>
    </div>

    <div id="licenseLocationReportModal" class="modal fade" role="dialog">
	    <div class="modal-dialog modal-dialog-scrollable modal-lg">
	        <div class="modal-content">
	            <div class="modal-header">
	                <h4 class="modal-title">License Locations</h4>
	            </div>
	            <div class="modal-body">
	            	<div id="licenseLocationPiechart"></div>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	            </div>
	        </div>
	    </div>
	</div>

	<div id="licenseDepartmentReportModal" class="modal fade" role="dialog">
	    <div class="modal-dialog modal-dialog-scrollable modal-lg">
	        <div class="modal-content">
	            <div class="modal-header">
	                <h4 class="modal-title">License Departments</h4>
	            </div>
	            <div class="modal-body">
	            	<div id="licenseDepartmentPiechart" style="width: 1500px; height: 1000px;"></div>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	            </div>
	        </div>
	    </div>
	</div>

	<div id="assetLocationReportModal" class="modal fade" role="dialog">
	    <div class="modal-dialog modal-dialog-scrollable modal-lg">
	        <div class="modal-content">
	            <div class="modal-header">
	                <h4 class="modal-title">Asset Locations</h4>
	            </div>
	            <div class="modal-body">
	            	<div id="assetLocationPiechart" style="width: 1500px; height: 1000px;"></div>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	            </div>
	        </div>
	    </div>
	</div>

	<div id="assetDepartmentReportModal" class="modal fade" role="dialog">
	    <div class="modal-dialog modal-dialog-scrollable modal-lg">
	        <div class="modal-content">
	            <div class="modal-header">
	                <h4 class="modal-title">Asset Departments</h4>
	            </div>
	            <div class="modal-body">
	            	<div id="assetDepartmentPiechart" style="width: 1500px; height: 1000px;"></div>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	            </div>
	        </div>
	    </div>
	</div>

	<div id="expriryLicensesModal" class="modal fade" role="dialog">
	    <div class="modal-dialog modal-dialog-scrollable modal-lg">
	        <div class="modal-content">
	            <div class="modal-header">
	                <h4 class="modal-title">Licenses with Expiry Dates</h4>
	            </div>
	            <div class="modal-body">
	            	<div id="expriryLicenses-Table"></div>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	            </div>
	        </div>
	    </div>
	</div>

	<div id="expriredLicensesModal" class="modal fade" role="dialog">
	    <div class="modal-dialog modal-dialog-scrollable modal-lg">
	        <div class="modal-content">
	            <div class="modal-header">
	                <h4 class="modal-title">Expired</h4>
	            </div>
	            <div class="modal-body">
	            	<div id="expriredLicenses-Table"></div>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	            </div>
	        </div>
	    </div>
	</div>

	<div id="expriringLicensesModal" class="modal fade" role="dialog">
	    <div class="modal-dialog modal-dialog-scrollable modal-lg">
	        <div class="modal-content">
	            <div class="modal-header">
	                <h4 class="modal-title">Expirying in 30 days</h4>
	            </div>
	            <div class="modal-body">
	            	<div id="expriringLicenses-Table"></div>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	            </div>
	        </div>
	    </div>
	</div>

	<div id="archivedLicensesModal" class="modal fade" role="dialog">
	    <div class="modal-dialog modal-dialog-scrollable modal-lg">
	        <div class="modal-content">
	            <div class="modal-header">
	                <h4 class="modal-title">Archived</h4>
	            </div>
	            <div class="modal-body">
	            	<div id="archivedLicenses-Table"></div>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	            </div>
	        </div>
	    </div>
	</div>

</body>

<script>
	google.charts.load('current', {'packages':['corechart']});

	var belfastLicenseCounter;
	var dublinLicenseCounter ;
	var cardiffLicenseCounter;
	var londonLicenseCounter;
	var edinburghLicenseCounter;

	var licenseLocationDataArray;

	var financeLicenseCounter;
	var salesLicenseCounter;
	var facilitiesLicenseCounter;
	var iTLicenseCounter;
	var manufacturingLicenseCounter;
	var logisitcsLicenseCounter;

	var licenseDepartmentDataArray;

	var belfastAssetCounter;
	var dublinAssetCounter ;
	var cardiffAssetCounter;
	var londonAssetCounter;
	var edinburghAssetCounter;

	var assetLocationDataArray;

	var financeAssetCounter;
	var salesAssetCounter;
	var facilitiesAssetCounter;
	var iTAssetCounter;
	var manufacturingAssetCounter;
	var logisitcsAssetCounter;

	var assetDepartmentDataArray;

	var exprireLicensesTableData;
	var expriredLicensesTableData;
	var expriringLicensesTableData;

	var archivedLicensesTableData;

	function drawChart(dataArray, title, divID)
		{
	        var data = google.visualization.arrayToDataTable(dataArray);

	        var options = {
	         // 'title' : title,
	         'width' : '100%',
	         'height' : '100%'};


	        var chart = new google.visualization.PieChart(document.getElementById(divID));

	        chart.draw(data, options);
    	}

	function licenseLocationReport()
		{
			belfastLicenseCounter = 0;
			dublinLicenseCounter = 0;
			cardiffLicenseCounter= 0;
			londonLicenseCounter= 0;
			edinburghLicenseCounter= 0;
			
			getLicenseLocationStats();
			
			$("#licenseLocationReportModal").modal("toggle");
		}

	function getLicenseLocationStats()
		{
			var xmlHttp = new XMLHttpRequest();
			var theURL = "http://localhost:8080/license_assign"
			xmlHttp.onreadystatechange = function()
	            {
	                if (this.readyState == 4 && this.status == 200)
	                {
	                 var myList1 = (this.responseText);
	                 var localTD = JSON.parse(myList1);

	                 for (var i = 0; i < localTD.length; i++)
	                 {
	                 	for (var x = 0; x < localTD[i].tagSet.length; x++)
	                 	{
	                 		switch (localTD[i].tagSet[x].tagValue)
	                 		{
	                 			case "Belfast":
	                 			belfastLicenseCounter++;
	                 			break;

	                 			case "Dublin":
	                 			dublinLicenseCounter++;
	                 			break;

	                 			case "London":
	                 			londonLicenseCounter++;
	                 			break;

	                 			case "Edinburgh":
	                 			edinburghLicenseCounter++;
	                 			break;

	                 			case "Cardiff":
	                 			cardiffLicenseCounter++;
	                 			break;
	                 			default:
	                 			
	                 		}

	                 		licenseLocationDataArray =[
	                 		['Key', 'Value'],
	          				['Belfast',     belfastLicenseCounter],
	         				['Dublin',      dublinLicenseCounter],
					        ['London',  londonLicenseCounter],
					        ['Edinburgh', edinburghLicenseCounter],
					        ['Cardiff',    cardiffLicenseCounter]
					        ];

					        // google.charts.setOnLoadCallback(drawLicenseLocationChart);

							drawChart(licenseLocationDataArray, 'License location', 'licenseLocationPiechart');
	                 	}
	                 }
	                }
	            };
	            xmlHttp.open("GET", theURL , true);
	            xmlHttp.send();
		}

    function licenseDepartmentReport()
		{
			financeLicenseCounter = 0;
			salesLicenseCounter = 0;
			facilitiesLicenseCounter= 0;
			iTLicenseCounter= 0;
			manufacturingLicenseCounter= 0;
			logisitcsLicenseCounter=0;

			getLicenseDepartmentStats();
			$("#licenseDepartmentReportModal").modal("toggle");
		}
    
    function getLicenseDepartmentStats()
		{
			var xmlHttp = new XMLHttpRequest();
			var theURL = "http://localhost:8080/license_assign"
			xmlHttp.onreadystatechange = function()
	            {
	                if (this.readyState == 4 && this.status == 200)
	                {
	                 var myList1 = (this.responseText);
	                 var localTD = JSON.parse(myList1);

	                 for (var i = 0; i < localTD.length; i++)
	                 {
	                 	for (var x = 0; x < localTD[i].tagSet.length; x++)
	                 	{
	                 		switch (localTD[i].tagSet[x].tagValue)
	                 		{
	                 			case "Finance":
	                 			financeLicenseCounter++;
	                 			break;

	                 			case "Sales":
	                 			salesLicenseCounter++;
	                 			break;

	                 			case "Facilities":
	                 			facilitiesLicenseCounter++;
	                 			break;

	                 			case "IT":
	                 			iTLicenseCounter++;
	                 			break;

	                 			case "Manufacturing":
	                 			manufacturingLicenseCounter++;
	                 			break;

	                 			case "Logisitcs":
	                 			logisitcsLicenseCounter++;
	                 			break;
	                 			default:
	                 			
	                 		}
	                 	}

	                 		licenseDepartmentDataArray =[
	                 		['Key', 'Value'],
	          				['Finance',     financeLicenseCounter],
	         				['Sales',      salesLicenseCounter],
	         				['Facilities',      facilitiesLicenseCounter],
					        ['IT',  iTLicenseCounter],
					        ['Manufacturing', manufacturingLicenseCounter],
					        ['Logisitcs',    logisitcsLicenseCounter]
					        ];

					        drawChart(licenseDepartmentDataArray, 'License Department', 'licenseDepartmentPiechart');
					        
	                 }
	                }
	            };
	            xmlHttp.open("GET", theURL , true);
	            xmlHttp.send();
		}

    function assetLocationReport()
		{
			belfastAssetCounter = 0;
			dublinAssetCounter = 0;
			cardiffAssetCounter= 0;
			londonAssetCounter= 0;
			edinburghAssetCounter= 0;
			getAssetLocationStats();
			$("#assetLocationReportModal").modal("toggle");
		}

	function getAssetLocationStats()
		{
			var xmlHttp = new XMLHttpRequest();
			var theURL = "http://localhost:8080/asset_assign"
			xmlHttp.onreadystatechange = function()
	            {
	                if (this.readyState == 4 && this.status == 200)
	                {
	                 var myList1 = (this.responseText);
	                 var localTD = JSON.parse(myList1);

	                 for (var i = 0; i < localTD.length; i++)
	                 {
	                 	for (var x = 0; x < localTD[i].tagSet.length; x++)
	                 	{
	                 		switch (localTD[i].tagSet[x].tagValue)
	                 		{
	                 			case "Belfast":
	                 			belfastAssetCounter++;
	                 			break;

	                 			case "Dublin":
	                 			dublinAssetCounter++;
	                 			break;

	                 			case "London":
	                 			londonAssetCounter++;
	                 			break;

	                 			case "Edinburgh":
	                 			edinburghAssetCounter++;
	                 			break;

	                 			case "Cardiff":
	                 			cardiffAssetCounter++;
	                 			break;
	                 			default:
	                 			
	                 		}

	                 		assetLocationDataArray =[
	                 		['Key', 'Value'],
	          				['Belfast',     belfastAssetCounter],
	         				['Dublin',      dublinAssetCounter],
					        ['London',  londonAssetCounter],
					        ['Edinburgh', edinburghAssetCounter],
					        ['Cardiff',    cardiffAssetCounter]
					        ];

					        drawChart(assetLocationDataArray, 'Asset location', 'assetLocationPiechart');
	                 	}
	                 }
	                }
	            };
	            xmlHttp.open("GET", theURL , true);
	            xmlHttp.send();
		}

    function assetDepartmentReport()
		{
			financeAssetCounter = 0;
			salesAssetCounter = 0;
			facilitiesAssetCounter= 0;
			iTAssetCounter= 0;
			manufacturingAssetCounter= 0;
			logisitcsAssetCounter=0;
			getAssetDepartmentStats();
			$("#assetDepartmentReportModal").modal("toggle");
		}
    
    function getAssetDepartmentStats()
		{
			var xmlHttp = new XMLHttpRequest();
			var theURL = "http://localhost:8080/asset_assign"
			xmlHttp.onreadystatechange = function()
	            {
	                if (this.readyState == 4 && this.status == 200)
	                {
	                 var myList1 = (this.responseText);
	                 var localTD = JSON.parse(myList1);

	                 for (var i = 0; i < localTD.length; i++)
	                 {
	                 	for (var x = 0; x < localTD[i].tagSet.length; x++)
	                 	{
	                 		switch (localTD[i].tagSet[x].tagValue)
	                 		{
	                 			case "Finance":
	                 			financeAssetCounter++;
	                 			break;

	                 			case "Sales":
	                 			salesAssetCounter++;
	                 			break;

	                 			case "Facilities":
	                 			facilitiesAssetCounter++;
	                 			break;

	                 			case "IT":
	                 			iTAssetCounter++;
	                 			break;

	                 			case "Manufacturing":
	                 			manufacturingAssetCounter++;
	                 			break;

	                 			case "Logisitcs":
	                 			logisitcsAssetCounter++;
	                 			break;
	                 			default:
	                 			
	                 		}
	                 	}

	                 		assetDepartmentDataArray =[
	                 		['Key', 'Value'],
	          				['Finance',     financeAssetCounter],
	         				['Sales',      salesAssetCounter],
	         				['Facilities',      facilitiesAssetCounter],
					        ['IT',  iTAssetCounter],
					        ['Manufacturing', manufacturingAssetCounter],
					        ['Logisitcs',    logisitcsAssetCounter]
					        ];

					        drawChart(assetDepartmentDataArray, 'Asset Department', 'assetDepartmentPiechart');
					        
	                 }
	                }
	            };
	            xmlHttp.open("GET", theURL , true);
	            xmlHttp.send();
		}

    function startExpiryLicenses()
	    {
	    	getExpriryLicenses();
	    	
	    	$("#expriryLicensesModal").modal("toggle");
	    }

    function startExpiredLicenses()
	    {
	    	getExpiredLicenses();
	    	
	    	$("#expriredLicensesModal").modal("toggle");
	    }

    function startExpiringLicenses()
	    {
	    	getExpriringLicenses();
	    	
	    	$("#expriringLicensesModal").modal("toggle");
	    }
    
    function getExpriryLicenses()
	      {
	        var xmlHttp = new XMLHttpRequest();
	        var theURL = "http://localhost:8080/license/expiry"
	        xmlHttp.onreadystatechange = function()
	          {
	            console.log(this.status);
	            if (this.readyState == 4 && this.status == 200)
	            {
	            var myList1 = (this.responseText);
	            var localTD = JSON.parse(myList1);
	          	expriryLicensesTableData = localTD;
	          	console.log(expriryLicensesTableData);
	          	buildTable("#expriryLicenses-Table", expriryLicensesTableData);
	            }
	          };
	          xmlHttp.open("GET", theURL , true);
	          xmlHttp.send();
	      }

    function getExpiredLicenses()
	      {
	        var xmlHttp = new XMLHttpRequest();
	        var theURL = "http://localhost:8080/license/expired"
	        xmlHttp.onreadystatechange = function()
	          {
	            
	            if (this.readyState == 4 && this.status == 200)
	            {
	            var myList1 = (this.responseText);
	            var localTD = JSON.parse(myList1);
	          	expriredLicensesTableData = localTD;
	          	buildTable("#expriredLicenses-Table", expriredLicensesTableData);
	            }
	          };
	          xmlHttp.open("GET", theURL , true);
	          xmlHttp.send();
	      }

    function getExpriringLicenses()
	      {
	        var xmlHttp = new XMLHttpRequest();
	        var theURL = "http://localhost:8080/license/expiring"
	        xmlHttp.onreadystatechange = function()
	          {
	            if (this.readyState == 4 && this.status == 200)
	            {
	            var myList1 = (this.responseText);
	            var localTD = JSON.parse(myList1);
	          	expriringLicensesTableData = localTD;
	          	console.log(expriringLicensesTableData);
	          	buildTable("#expriringLicenses-Table", expriringLicensesTableData);
	            }
	          };
	          xmlHttp.open("GET", theURL , true);
	          xmlHttp.send();
	      }

    function buildTable(table, tableData)
	      {

	          table = new Tabulator(table,
	              {
	                  data:tableData,
	                  layout:"fitColumns",
	                  paginationSize:5,
	                  movableColumns:true,
	                  resizableRows:true,
	                  printAsHtml:true,
	                  columns:[
	                  {formatter:"rownum", hozAlign:"center", width:40},
	                  {title:"Software Name", field:"softwareName", hozAlign:"left"},
	                  {title:"Version", field:"softwareVersion", hozAlign:"left"},
	                  {title:"License Key", field:"licenseKey", hozAlign:"left"},
	                  {title:"Purchase Date", field:"purchaseDate", hozAlign:"left"},
	                  {title:"Expiry Date", field:"expiryDate", hozAlign:"left"},
	                  ],
	                  rowClick:function(e, row)
	                  {
	                    
	                  }
	              }
	          );
	      }

    function startArchivedLicenses()
	    {
	    	getArchivedLicenses();
	    	
	    	$("#archivedLicensesModal").modal("toggle");
	    }

    function getArchivedLicenses()
	      {
	        var xmlHttp = new XMLHttpRequest();
	        var theURL = "http://localhost:8080/license_archive"
	        xmlHttp.onreadystatechange = function()
	          {
	            if (this.readyState == 4 && this.status == 200)
	            {
	            var myList1 = (this.responseText);
	            var localTD = JSON.parse(myList1);
	          	archivedLicensesTableData = localTD;
	          	buildTable("#archivedLicenses-Table", archivedLicensesTableData);
	            }
	          };
	          xmlHttp.open("GET", theURL , true);
	          xmlHttp.send();
	      }

</script>
</html>